<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photorealistic Prompt Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer components {
            .btn-primary {
                @apply inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500;
            }
            .btn-secondary {
                @apply inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500;
            }
            .form-input {
                @apply w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-primary-500 focus:border-primary-500;
            }
            .form-output {
                @apply w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-gray-50 dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-primary-500 focus:border-primary-500;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-200">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <header class="flex justify-between items-center mb-8">
            <div class="text-center flex-1">
                <h1 class="text-4xl font-bold text-gray-800 dark:text-white">Photorealistic Prompt Generator</h1>
                <p class="text-gray-600 dark:text-gray-400 mt-2">Create detailed prompts for photorealistic image generation</p>
            </div>
            <button id="themeToggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none">
                <i class="fas fa-moon dark:hidden"></i>
                <i class="fas fa-sun hidden dark:block"></i>
            </button>
        </header>

        <main class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 mb-6 transition-colors duration-200">
            <form id="promptForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="subject" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Subject <span class="text-red-500">*</span></label>
                        <input type="text" id="subject" name="subject" placeholder="e.g., A tabby cat sitting on a windowsill" 
                               class="form-input">
                    </div>

                    <div>
                        <label for="environment" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Environment & Mood</label>
                        <div class="relative">
                            <input type="text" id="environment" name="environment" placeholder="e.g., cozy apartment interior, morning sunlight" 
                                   class="form-input">
                            <button type="button" class="field-random-btn absolute right-2 top-2 text-gray-400 dark:text-gray-500 hover:text-primary-500 dark:hover:text-primary-400" data-field="environment">
                                <i class="fas fa-random"></i>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label for="composition" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Composition & Framing</label>
                        <div class="relative">
                            <input type="text" id="composition" name="composition" placeholder="e.g., close-up shot, rule of thirds" 
                                   class="form-input">
                            <button type="button" class="field-random-btn absolute right-2 top-2 text-gray-400 dark:text-gray-500 hover:text-primary-500 dark:hover:text-primary-400" data-field="composition">
                                <i class="fas fa-random"></i>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label for="lighting" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Lighting & Color</label>
                        <div class="relative">
                            <input type="text" id="lighting" name="lighting" placeholder="e.g., warm golden light, soft shadows" 
                                   class="form-input">
                            <button type="button" class="field-random-btn absolute right-2 top-2 text-gray-400 dark:text-gray-500 hover:text-primary-500 dark:hover:text-primary-400" data-field="lighting">
                                <i class="fas fa-random"></i>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label for="camera" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Camera & Technical Specs</label>
                        <div class="relative">
                            <input type="text" id="camera" name="camera" placeholder="e.g., shot on Nikon D850, 85mm f/1.4 lens" 
                                   class="form-input">
                            <button type="button" class="field-random-btn absolute right-2 top-2 text-gray-400 dark:text-gray-500 hover:text-primary-500 dark:hover:text-primary-400" data-field="camera">
                                <i class="fas fa-random"></i>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label for="style" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Style & Quality Keywords</label>
                        <div class="relative">
                            <input type="text" id="style" name="style" placeholder="e.g., photorealistic, highly detailed, professional" 
                                   class="form-input">
                            <button type="button" class="field-random-btn absolute right-2 top-2 text-gray-400 dark:text-gray-500 hover:text-primary-500 dark:hover:text-primary-400" data-field="style">
                                <i class="fas fa-random"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div>
                    <label for="negative" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Negative Prompts</label>
                    <div class="relative">
                        <input type="text" id="negative" name="negative" placeholder="e.g., blurry, low quality, distorted, oversaturated" 
                               class="form-input">
                        <button type="button" class="field-random-btn absolute right-2 top-2 text-gray-400 dark:text-gray-500 hover:text-primary-500 dark:hover:text-primary-400" data-field="negative">
                            <i class="fas fa-random"></i>
                        </button>
                    </div>
                </div>

                <div class="flex flex-wrap justify-between gap-2 pt-4">
                    <div class="flex gap-2">
                        <button type="button" id="randomizeBtn" class="btn-primary bg-green-600 hover:bg-green-700 focus:ring-green-500">
                            <i class="fas fa-random mr-2"></i> Randomize All
                        </button>
                        <button type="button" id="clearBtn" class="btn-secondary">
                            <i class="fas fa-trash-alt mr-2"></i> Clear All
                        </button>
                    </div>
                    <div>
                        <button type="button" id="savePresetBtn" class="btn-primary bg-purple-600 hover:bg-purple-700 focus:ring-purple-500">
                            <i class="fas fa-save mr-2"></i> Save Preset
                        </button>
                    </div>
                </div>

                <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center mb-1">
                        <label for="output" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Generated Prompt</label>
                        <div id="copyStatus" class="text-sm text-green-600 dark:text-green-400 opacity-0 transition-opacity duration-1000">
                            <i class="fas fa-check-circle mr-1"></i> Copied to clipboard
                        </div>
                    </div>
                    <div class="relative">
                        <textarea id="output" rows="3" readonly class="form-output"></textarea>
                        <button type="button" id="copyBtn" class="absolute bottom-2 right-2 inline-flex items-center px-2 py-1 border border-transparent rounded text-xs font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <i class="fas fa-copy mr-1"></i> Copy
                        </button>
                    </div>
                    
                    <div class="mt-3">
                        <label for="negativeOutput" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Negative Prompt</label>
                        <div class="relative">
                            <textarea id="negativeOutput" rows="2" readonly class="form-output"></textarea>
                            <button type="button" id="copyNegativeBtn" class="absolute bottom-2 right-2 inline-flex items-center px-2 py-1 border border-transparent rounded text-xs font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500">
                                <i class="fas fa-copy mr-1"></i> Copy
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex justify-end mt-3">
                        <button type="button" id="copyBothBtn" class="btn-primary">
                            <i class="fas fa-copy mr-1"></i> Copy Both
                        </button>
                    </div>
                </div>
            </form>
        </main>

        <div id="savedPresets" class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 hidden transition-colors duration-200">
            <h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Saved Presets</h2>
            <div id="presetList" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Presets will be added here dynamically -->
            </div>
        </div>
        
        <div id="promptHistory" class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 mb-6 transition-colors duration-200">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-medium text-gray-900 dark:text-white">Prompt History</h2>
                <div class="flex gap-2">
                    <button id="clearHistoryBtn" class="btn-secondary text-xs py-1 px-2">
                        <i class="fas fa-trash-alt mr-1"></i> Clear History
                    </button>
                    <button id="toggleHistoryBtn" class="btn-secondary text-xs py-1 px-2">
                        <i class="fas fa-chevron-up" id="historyCollapseIcon"></i>
                    </button>
                </div>
            </div>
            <div id="historyContent">
                <div class="text-sm text-gray-500 dark:text-gray-400 italic mb-4">
                    Recent prompts will appear here. Click on any prompt to restore it.
                </div>
                <div id="historyList" class="space-y-3">
                    <!-- History items will be added here dynamically -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM elements
        const form = document.getElementById('promptForm');
        const outputField = document.getElementById('output');
        const negativeOutputField = document.getElementById('negativeOutput');
        const copyBtn = document.getElementById('copyBtn');
        const copyNegativeBtn = document.getElementById('copyNegativeBtn');
        const copyBothBtn = document.getElementById('copyBothBtn');
        const randomizeBtn = document.getElementById('randomizeBtn');
        const clearBtn = document.getElementById('clearBtn');
        const savePresetBtn = document.getElementById('savePresetBtn');
        const copyStatus = document.getElementById('copyStatus');
        const savedPresetsContainer = document.getElementById('savedPresets');
        const presetList = document.getElementById('presetList');
        const fieldRandomBtns = document.querySelectorAll('.field-random-btn');
        const themeToggle = document.getElementById('themeToggle');
        const promptHistoryContainer = document.getElementById('promptHistory');
        const historyList = document.getElementById('historyList');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const toggleHistoryBtn = document.getElementById('toggleHistoryBtn');
        const historyContent = document.getElementById('historyContent');
        const historyCollapseIcon = document.getElementById('historyCollapseIcon');
        
        const inputFields = [
            'subject', 'environment', 'composition', 
            'lighting', 'camera', 'style', 'negative'
        ];

        // Auto-copy flag
        let autoCopyEnabled = true;
        
        // History collapsed state
        let historyCollapsed = false;

        // Load saved presets from localStorage
        const savedPresets = JSON.parse(localStorage.getItem('photoPromptPresets')) || [];
        
        // Load prompt history from localStorage
        const promptHistory = JSON.parse(localStorage.getItem('photoPromptHistory')) || [];
        
        // Maximum number of history items to keep
        const MAX_HISTORY_ITEMS = 10;

        // Initialize the app
        initApp();

        function initApp() {
            // Set up theme preference
            initTheme();
            
            // Set up event listeners
            inputFields.forEach(field => {
                const input = document.getElementById(field);
                input.addEventListener('input', handleInputChange);
            });

            // Set up individual field randomizers
            fieldRandomBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const field = btn.dataset.field;
                    if (variations[field]) {
                        document.getElementById(field).value = getRandomItem(variations[field]);
                        updateOutput();
                    }
                });
            });

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // History toggle
            toggleHistoryBtn.addEventListener('click', toggleHistory);
            
            // Clear history
            clearHistoryBtn.addEventListener('click', clearHistory);

            // Show saved presets if any exist
            updatePresetsDisplay();
            
            // Show prompt history if any exists
            updateHistoryDisplay();
        }

        function initTheme() {
            // Check for saved theme preference or respect OS preference
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function toggleTheme() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
        }

        function handleInputChange() {
            updateOutput();
        }

        // Predefined variations for each component (20 options each)
        const variations = {
            environment: [
                "cozy apartment interior, morning sunlight, peaceful atmosphere",
                "misty forest at dawn, ethereal, mysterious",
                "bustling cityscape at night, neon lights, urban energy",
                "serene beach at sunset, golden hour, tranquil",
                "rustic cabin in snow-covered mountains, warm fireplace glow",
                "lush tropical jungle, vibrant, exotic",
                "abandoned industrial warehouse, gritty, dramatic",
                "elegant Victorian mansion, moody, historical",
                "futuristic sci-fi metropolis, high-tech, sleek",
                "underwater coral reef, dreamlike, surreal",
                "vast desert landscape, harsh sun, desolate beauty",
                "rainy city streets at night, reflective surfaces, melancholic",
                "enchanted garden, magical, whimsical",
                "classic art museum, cultured, sophisticated",
                "countryside farmhouse, nostalgic, idyllic",
                "steampunk workshop, intricate, brass and copper tones",
                "zen Japanese garden, minimalist, harmonious",
                "stormy ocean, powerful waves, dramatic weather",
                "ancient ruins, archaeological, mysterious",
                "cozy coffee shop, warm ambiance, inviting",
                "mountain summit at sunrise, majestic, expansive views",
                "autumn forest, rich colors, falling leaves, nostalgic",
                "snow-covered park in winter, pristine, peaceful",
                "Mediterranean seaside village, whitewashed buildings, azure water",
                "volcanic landscape, rugged terrain, geothermal activity",
                "lavender fields in Provence, aromatic, purple haze",
                "dense fog rolling over coastal cliffs, mysterious",
                "rooftop garden in urban setting, oasis, city views",
                "hidden mountain hot springs, steamy, secluded",
                "gothic cathedral interior, stained glass, reverent atmosphere",
                "space station observatory, Earth view, technological",
                "cherry blossom park in full bloom, delicate pink, serene",
                "post-apocalyptic urban ruins, haunting, desolate",
                "traditional Middle Eastern market, vibrant, bustling",
                "lighthouse on rocky shore, stormy sea, dramatic",
                "retro 1950s diner, nostalgic Americana, vintage",
                "terraced rice fields, geometric patterns, lush green",
                "frozen lake in winter, ice crystals, stark beauty",
                "old library with towering bookshelves, scholarly, timeless",
                "midnight in Paris, romantic, iconic landmarks",
                "Scandinavian minimalist interior, clean lines, hygge",
                "overgrown secret garden, wild, forgotten beauty",
                "Art Deco hotel lobby, glamorous, 1920s elegance",
                "bioluminescent bay at night, glowing waters, magical",
                "alpine meadow in spring, wildflowers, majestic peaks",
                "historic train station, grand architecture, bustling",
                "Moroccan riad courtyard, intricate tiles, fountain",
                "wild west ghost town, abandoned, tumbleweed",
                "urban graffiti alley, colorful street art, gritty",
                "floating market in Thailand, vibrant, traditional boats",
                "misty mountain temple, spiritual, ancient",
                "Arctic tundra, northern lights, pristine wilderness",
                "New Orleans French Quarter, jazz atmosphere, historic",
                "Venetian canals, gondolas, romantic Italian architecture",
                "wild Scottish highlands, rugged, atmospheric fog",
                "hidden cenote in Mexican jungle, crystal clear water",
                "bamboo forest path, dappled light, tranquil",
                "California wine country, rolling vineyards, golden light",
                "Kyoto during autumn, traditional Japanese architecture",
                "London street in the rain, iconic red phone booth",
                "ancient olive grove in Mediterranean countryside",
                "small-town main street, Americana, nostalgic charm",
                "coral atoll from above, turquoise waters, white sand",
                "bustling Tokyo intersection at night, neon signs, modern",
                "Santorini cliffside, white buildings, blue domes",
                "desert oasis with palm trees, refreshing pool, sanctuary",
                "morning mist in Amazonian rainforest, primeval, lush",
                "Brooklyn brownstone street, urban charm, tree-lined",
                "Himalayan mountain pass, remote, spiritual journey",
                "underground crystal cave, otherworldly formations, magical"
            ],
            composition: [
                "close-up shot, rule of thirds, shallow depth of field",
                "wide angle panorama, expansive, capturing scale",
                "overhead aerial perspective, geometric patterns visible",
                "extreme macro shot, intricate details revealed",
                "dutch angle, dynamic tension, cinematic framing",
                "symmetrical composition, balanced, formal",
                "leading lines drawing eye to focal point",
                "silhouette against bright background, dramatic contrast",
                "frame within a frame composition, layered depth",
                "low angle shot, imposing, powerful perspective",
                "split-field composition, juxtaposition of elements",
                "rule of odds, visual harmony, pleasing arrangement",
                "diagonal composition, dynamic energy, movement",
                "minimalist negative space emphasizing subject",
                "foreground framing elements adding depth",
                "bokeh background, subject isolation, dreamy quality",
                "layered composition, multiple planes of focus",
                "golden ratio spiral composition, classical balance",
                "repetition of elements creating rhythm and pattern",
                "environmental portrait showing context and character",
                "forced perspective, optical illusion, creative framing",
                "diptych composition, side-by-side visual comparison",
                "radial composition, central focus, spiraling outward",
                "triangular composition, stable, classic arrangement",
                "contre-jour backlighting, rim light, dramatic silhouettes",
                "vanishing point perspective, converging lines, depth",
                "telephoto compression, flattened perspective, stacked planes",
                "tilt-shift effect, selective focus, miniature appearance",
                "fisheye distortion, curved horizon, exaggerated foreground",
                "S-curve composition, flowing visual path, elegant",
                "quadrant composition, four distinct areas, balanced",
                "center-weighted composition, formal, direct focus",
                "dynamic asymmetry, balanced imbalance, tension",
                "high-angle overhead shot, revealing context, pattern",
                "cinematic widescreen aspect ratio, 2.35:1, filmic",
                "panoramic 360-degree view, immersive, all-encompassing",
                "triptych panel composition, narrative sequence, related images",
                "mirrored reflection composition, symmetry, doubling",
                "telephoto isolating shot, compressed perspective, intimate",
                "elevated three-quarter view, revealing spatial relationships",
                "juxtaposition of scale, size contrast, perspective play",
                "geometric division, rule of thirds grid, precise placement",
                "atmospheric perspective, depth through fading distance",
                "square format composition, Instagram-friendly, balanced",
                "binary composition, two dominant elements, comparative",
                "vignette framing, darkened edges, central focus",
                "stacked perspective, vertical layers, height emphasis",
                "dynamic cross composition, intersecting focal lines",
                "parallax layers, moving elements, dimensional depth",
                "pattern interruption, repetition with focal break",
                "sequential narrative composition, visual storytelling",
                "framing within environmental context, establishing shot",
                "foreground object partially obscuring view, mysterious",
                "converging diagonal lines, dynamic tension, movement",
                "visual hierarchy through size variation, importance scaling",
                "natural framing using environmental elements, context",
                "flat lay overhead composition, organized arrangement",
                "multi-point perspective, complex spatial relationships",
                "figure-ground relationship, subject/background contrast",
                "circular composition, eye movement around frame",
                "visual weight balance, asymmetrical counterbalance",
                "compressed layers, telephoto stacking, distinct planes",
                "tertiary composition, three balanced elements, triangle",
                "implied movement through directional cues, visual flow",
                "negative space portraiture, minimalist emotional impact",
                "atmospheric layering, depth through haze elements",
                "split composition, distinct visual division, contrast",
                "perspective distortion, wide angle exaggeration, drama",
                "cross-polarized lighting composition, revealing stress patterns"
            ],
            lighting: [
                "warm golden light, soft shadows, muted color palette",
                "dramatic chiaroscuro lighting, high contrast, moody",
                "cool blue twilight, ethereal glow, mysterious atmosphere",
                "high-key lighting, bright and airy, minimal shadows",
                "low-key lighting, dramatic shadows, noir-inspired",
                "split lighting, half illuminated face, character study",
                "rim lighting silhouetting subject against dark background",
                "dappled light filtering through trees, organic patterns",
                "golden hour sunset glow, warm orange tones",
                "harsh midday sun, strong shadows, vibrant colors",
                "soft diffused light, gentle gradients, dreamy quality",
                "blue hour lighting, twilight ambiance, serene mood",
                "neon lighting, cyberpunk aesthetic, vibrant colors",
                "candlelight, intimate, warm amber glow",
                "foggy diffusion, mysterious atmosphere, limited visibility",
                "backlit silhouette, dramatic outline, mysterious",
                "studio three-point lighting, professional, controlled",
                "bioluminescent glow, otherworldly, magical quality",
                "high contrast black and white, timeless, dramatic",
                "colorful gel lighting, creative, artistic expression",
                "underwater caustics, rippling light patterns, aquatic ambiance",
                "northern lights, green and purple aurora, magical sky",
                "soft window light, Vermeer-inspired, painterly quality",
                "silky moonlight, silver-blue glow, romantic night scene",
                "dramatic side lighting, strong sculptural shadows, dimension",
                "cinematic anamorphic lens flare, horizontal blue streaks",
                "rainbow spectrum lighting, prismatic color separation",
                "sunset silhouette backlighting, golden outlines, drama",
                "volumetric light beams, visible light rays, atmospheric",
                "lightning illumination, momentary flash, dramatic weather",
                "fire glow, dancing warm light, primal atmosphere",
                "light painting, long exposure streaks, creative patterns",
                "projected pattern lighting, textured overlay, dimension",
                "light through stained glass, colorful patterns, sacred",
                "autumn golden light, warm amber color cast, nostalgic",
                "concert stage lighting, dramatic spotlights, performance",
                "morning mist with sunbeams, ethereal rays, atmospheric",
                "cinematic day for night, blue moonlight simulation",
                "vintage film look, muted contrast, analog color science",
                "dramatic thunderstorm lighting, ominous, powerful",
                "sunset golden hour rim light, warm edge definition",
                "desert harsh light, extreme contrast, bleached highlights",
                "star trail long exposure, celestial movement, night sky",
                "light through crystal prism, rainbow spectrum, refraction",
                "sci-fi holographic lighting, futuristic blue glow",
                "theatrical spotlight, dramatic isolation, performance",
                "underwater green-blue gradient, depth filtration, aquatic",
                "light through fog machine, volumetric beam definition",
                "flashlight directional beam in darkness, investigative",
                "glowing ember light, warm red-orange, intimate",
                "city reflection puddle lighting, urban mirroring, rain",
                "double exposure lighting, overlapping illumination",
                "fairy lights bokeh, twinkling points, magical quality",
                "hard directional sunlight through blinds, film noir stripes",
                "studio beauty dish lighting, flattering portrait light",
                "lighthouse beacon, powerful directional beam, coastal",
                "light pollution glow, urban night sky, city ambiance",
                "sunset orange clouds, dramatic sky illumination",
                "sparkler light trails, celebration, dynamic movement",
                "firefly natural lighting, sporadic glowing points",
                "light through ice crystals, cold blue refraction",
                "light bands through canyons, directional shafts",
                "holiday string lights, festive warm glow, celebratory",
                "car headlights in fog, atmospheric beam cut, mysterious",
                "campfire lighting, primal warm glow, storytelling",
                "cinema projector beam, visible light shaft, theatrical",
                "light through cave opening, natural spotlight, revealing",
                "sunset alpenglow on mountains, pink-orange highlights",
                "godray lighting through clouds, heavenly beams, inspirational"
            ],
            camera: [
                "shot on Nikon D850, 85mm f/1.4 lens, ISO 100",
                "Canon EOS R5, 24-70mm f/2.8 lens, perfect focus",
                "Hasselblad medium format, 50MP, incredible detail",
                "Sony A7SIII, low-light performance, cinematic quality",
                "Leica M10, 35mm Summilux lens, street photography",
                "8x10 large format film camera, unparalleled resolution",
                "GFX 100S medium format, 100-megapixel resolution",
                "ARRI Alexa cinema camera, anamorphic lens, cinematic",
                "vintage Polaroid camera, authentic film texture",
                "Lomography film camera, grainy, nostalgic aesthetic",
                "iPhone 13 Pro computational photography, portrait mode",
                "drone aerial photography, DJI Mavic 3 Pro, bird's eye view",
                "underwater housing, Canon 5D Mark IV, aquatic clarity",
                "RED Digital Cinema camera, 8K resolution, RAW format",
                "tilt-shift photography, miniature effect, selective focus",
                "fisheye lens, 180-degree field of view, distorted perspective",
                "telephoto 400mm lens, compressed perspective, bokeh",
                "twin-lens reflex medium format, square frame, retro",
                "pinhole camera, dreamlike softness, infinite depth of field",
                "macro lens, 1:1 reproduction, extreme close-up detail",
                "Fujifilm X-T4, vintage film simulation, 26MP APS-C sensor",
                "Phase One IQ4 150MP, medium format digital back, studio quality",
                "Pentax 645Z medium format, landscape detail, 51MP",
                "Olympus OM-D E-M1X, micro four thirds, wildlife tracking",
                "Canon EOS C70 cinema camera, Super 35mm sensor, Log footage",
                "Linhof Technika large format, view camera movements, architectural",
                "Voigtländer Bessa rangefinder, street photography, manual focus",
                "Ricoh GR III, premium compact camera, 28mm equivalent lens",
                "Blackmagic Pocket Cinema Camera 6K, cinematic dynamic range",
                "Mamiya RZ67 Pro II, medium format film, portrait photography",
                "Sigma fp L, full-frame, 61MP sensor, compact body",
                "IMAX 70mm film camera, ultra-high resolution, immersive",
                "Sony FX6 cinema camera, full-frame sensor, 10-bit 4:2:2",
                "infrared converted camera, surreal landscapes, foliage glow",
                "Nikon Z9 flagship mirrorless, 45MP stacked CMOS sensor",
                "Rolleiflex TLR, waist-level finder, 6x6cm medium format",
                "Contax 645 medium format, Zeiss glass, bridal photography",
                "GoPro HERO10 Black, action camera, stabilized movement",
                "Zeiss ZX1 full-frame, integrated Lightroom, minimalist design",
                "4x5 field camera, long exposure, large format film sheet",
                "Panasonic S1H, full-frame cinema camera, 6K video",
                "Holga 120N toy camera, dreamy vignette, light leaks",
                "Leica Q2 Monochrom, 47MP dedicated black & white sensor",
                "Insta360 ONE R, 360-degree panoramic, immersive capture",
                "Fujifilm GFX 50S II, medium format, in-body stabilization",
                "Canon EOS-1D X Mark III, sports photography, 20fps burst",
                "Nikon F6, professional 35mm film SLR, last flagship film camera",
                "DJI Ronin 4D, stabilized cinema camera, LiDAR focusing",
                "PhaseOne XT field camera, 150MP IQ4 back, landscape master",
                "Canon R3 mirrorless, eye-controlled autofocus, stacked sensor",
                "scanning electron microscope photography, extreme magnification",
                "Sony RX1R II, full-frame compact, Zeiss 35mm f/2 lens",
                "ZCAM E2-F6, 6K full-frame cinema camera, ProRes RAW",
                "Horseman technical camera, movements, digital back adapter",
                "Nikon Z 9, 8K video, 45.7MP stacked CMOS sensor",
                "Lomography Sprocket Rocket, panoramic 35mm, exposed sprockets",
                "Pentax 67II, medium format film camera, portrait legend",
                "multicamera array, bullet-time effect, frozen moment",
                "Sinar P3 monorail view camera, perspective control, architectural",
                "Hasselblad 907X with CFV II 50C digital back, iconic design",
                "Plaubel Makina 67, folding medium format rangefinder",
                "microscope photography, polarized light, crystal structures",
                "Widelux F8, swing-lens panoramic film camera, 140° view",
                "Fujifilm GFX100, 102MP medium format, phase detection AF",
                "Lytro light field camera, post-capture focusing, computational",
                "URSA Mini Pro 12K, Super35 sensor, cinema production",
                "Kodak DCS Pro SLR/c, early DSLR, full-frame CCD",
                "ALPA 12 technical camera, precision Swiss engineering",
                "Nikon Z7 II, high-resolution mirrorless, 45MP sensor"
            ],
            style: [
                "photorealistic, highly detailed, professional photography, sharp focus, 4k",
                "hyperrealistic, indistinguishable from reality, perfect detail, 8k resolution",
                "photographic realism, DSLR photography, award-winning photojournalism",
                "documentary style, authentic photorealism, journalistic approach",
                "professional fashion photography, high-end production value, studio lighting",
                "National Geographic style, breathtaking realism, authentic documentation",
                "fine art photography, gallery-worthy, dramatic lighting, natural colors",
                "commercial photography aesthetic, polished, professional retouching",
                "analog film photography, genuine film grain, authentic color science",
                "black and white photography, rich contrast, fine details, dramatic shadows",
                "HDR photography, natural expanded dynamic range, realistic tones",
                "portrait studio photography, perfect skin texture, natural expressions",
                "professional architectural photography, precise lines, perfect perspective",
                "wildlife photography, natural habitat, authentic animal behavior",
                "street photography, candid moment, authentic scene, realistic colors",
                "landscape photography, natural vista, realistic atmospheric conditions",
                "photojournalistic style, authentic moment, real-world documentation",
                "minimalist photography, elegant simplicity, natural elements, realistic",
                "fashion editorial photography, high-end magazine quality, realistic details",
                "product photography, commercial quality, natural materials, realistic textures",
                "tilt-shift photography, selective focus, miniature effect, real-world scene",
                "macro photography, extreme close-up, intricate natural detail, realistic",
                "environmental portrait, contextual setting, authentic character, photographic",
                "aerial photography, drone perspective, real landscape, photographic quality",
                "time-lapse photography, temporal movement, natural phenomenon, realistic",
                "night photography, long exposure, star trails, authentic night sky",
                "underwater photography, aquatic environment, natural marine life, realistic",
                "sports photography, peak action moment, dynamic movement, photojournalistic",
                "concert photography, stage lighting, authentic performance, documentary",
                "food photography, appetizing presentation, natural ingredients, commercial quality",
                "still life photography, careful arrangement, studio lighting, realistic textures",
                "infrared photography, surreal foliage, alternative spectrum, photographic technique",
                "urban exploration photography, abandoned places, authentic decay, documentary",
                "architectural interior photography, spacial design, natural light, professional",
                "panoramic photography, wide vista, stitched perspective, immersive realism",
                "golden hour photography, warm natural lighting, atmospheric glow, realistic",
                "blue hour photography, twilight ambiance, architectural lighting, photographic",
                "light painting photography, long exposure technique, realistic night scene",
                "abstract architectural photography, geometric patterns, real structures, artistic",
                "cinematic photography, film still aesthetic, narrative moment, realistic",
                "storm photography, dramatic weather conditions, authentic natural phenomenon",
                "travel photography, cultural authenticity, destination realism, National Geographic",
                "lifestyle photography, authentic moments, natural interactions, commercial quality",
                "editorial photography, storytelling images, magazine quality, professional",
                "event photography, authentic moments, documentary approach, professional coverage",
                "automotive photography, professional car shoot, studio lighting, commercial quality",
                "celebrity portrait photography, professional headshot, magazine quality, authentic",
                "scientific photography, authentic natural specimen, detailed documentation",
                "high-speed photography, frozen moment, motion capture, technical achievement",
                "suburban photography, American lifestyle, authentic neighborhood, documentary",
                "microscopic photography, natural patterns, scientific documentation, highly detailed",
                "astrophotography, real celestial objects, telescope capture, scientifically accurate",
                "minimalist architectural photography, geometric simplicity, professional quality",
                "photographic triptych, related images, gallery presentation, artistic photography",
                "fashion lookbook photography, commercial styling, professional model, catalog quality",
                "corporate photography, professional business context, commercial polish",
                "winter landscape photography, snow conditions, natural lighting, realistic",
                "desert photography, arid landscape, natural formations, geographic documentation",
                "botanical photography, natural plant specimen, scientific detail, realistic",
                "coastal photography, seascape, natural tide patterns, photographic realism",
                "industrial photography, factory interior, working environment, documentary",
                "agriculture photography, farming landscape, rural documentation, authentic",
                "forensic photography, detailed evidence, scientific documentation, realistic",
                "vintage photography style, period-correct technique, authentic aging, realistic",
                "photogrammetry, 3D-captured real object, perfect textural detail, photorealistic",
                "advertising photography, commercial polish, product emphasis, professional",
                "decisive moment photography, Cartier-Bresson style, street realism, authentic",
                "satellite photography, Earth observation, genuine aerial perspective, scientific",
                "solar eclipse photography, astronomical event, scientific documentation",
                "cultural photography, authentic traditions, anthropological documentation"
            ],
            negative: [
                "cartoon, anime, illustration, painting, drawing, 3d render, cgi, computer generated",
                "artificial, unnatural, synthetic, plastic-looking, fake, airbrushed, overly-perfect",
                "poor composition, amateur, badly framed, overprocessed, unnatural colors",
                "overexposed, blown out highlights, harsh unflattering lighting, unnatural glow",
                "pixelated, low resolution, poor quality, compressed, artifacts, digital noise",
                "watermarks, signatures, text overlays, annotations, borders, frames",
                "heavily filtered, Instagram effect, over-saturated, unrealistic colors",
                "out of focus, soft focus, motion blur, camera shake, blurry details",
                "flash photography, harsh shadows, red-eye, unnatural reflections",
                "desaturated, washed out colors, faded, dull palette, flat lighting",
                "noisy, excessive grain, high ISO artifacts, digital sensor noise",
                "lens flare, dust spots, dirty lens, optical aberrations, chromatic aberration",
                "overprocessed HDR, unrealistic, cartoon-like effect, oversaturated colors",
                "poor color balance, incorrect white balance, color cast, unnatural skin tones",
                "bad lighting, unflattering shadows, poor contrast, flat lighting",
                "stock photo look, generic, commercial, artificial poses, forced expressions",
                "composited, photoshopped, manipulated, distorted proportions, warping",
                "fisheye distortion, barrel distortion, perspective issues, stretched edges",
                "underexposed, crushed blacks, muddy shadows, lacking detail in dark areas",
                "digital artifacts, banding, posterization, clipping, unrealistic textures",
                "AI-generated faces, uncanny valley, unnatural features, inhuman proportions",
                "halftone pattern, printed material, scan lines, magazine texture",
                "vignetting, excessive darkened corners, artificial framing effect",
                "stiff poses, awkward composition, amateur photography style",
                "selective color effect, partial desaturation, tacky processing",
                "green screen artifacts, poor compositing, obvious background replacement",
                "oversharpened, artificial clarity, exaggerated details, unnatural edges",
                "toy camera effect, fake vintage aesthetic, artificial light leaks",
                "inaccurate perspective, distorted proportions, warped angles",
                "unnatural shadows, inconsistent lighting direction, fake reflections",
                "heavy noise reduction, plastic skin, detail smoothing, waxy texture",
                "posterization, color banding, limited color depth, unnatural gradients",
                "cloned elements, repeated patterns, obvious healing brush artifacts",
                "HDR halo effect, glowing edges, unnatural local contrast",
                "wrong scale objects, size inconsistencies, proportion errors",
                "black and white conversion errors, uneven grayscale, strange luminance",
                "skin smoothing, airbrushed portraits, fake complexion, porcelain skin",
                "lens correction issues, stretching at edges, perspective distortion",
                "artificial film grain, fake analog effect, simulated vintage look",
                "color fringing, purple edges, chromatic aberration, lens defects",
                "improper exposure blending, ghosting artifacts, HDR problems",
                "tone mapping artifacts, local contrast issues, flat dimensionality",
                "cross-processing effect, unnatural color shifts, trendy filter",
                "simulated tilt-shift, fake miniature effect, forced selective focus",
                "overuse of clarity slider, grungy details, exaggerated texture",
                "fake bokeh, artificial background blur, portrait mode errors",
                "obvious automated sky replacement, horizon edge artifacts",
                "focus stacking errors, overlapping elements, blending issues",
                "diffraction issues, star-effect on highlights, lens aperture artifacts",
                "Newton rings, scanning artifacts, moire patterns, digitization errors",
                "lighting inconsistencies, multiple light sources, physical impossibilities",
                "over-retouched landscape, fantasy colors, impossible natural scene",
                "textureless surfaces, smooth plastic appearance, detail-less areas",
                "alignment issues, crooked horizon, unintentional dutch angle",
                "content-aware fill artifacts, smudged details, unnatural patterns",
                "solarization effect, tone reversal, unnatural contrast handling",
                "frame edge artifacts, sensor dust spots, technical flaws",
                "inaccurate reflections, physically impossible mirror effects",
                "bad frequency separation, texture/color separation artifacts",
                "mismatched perspective, impossible viewing angles, spatial errors",
                "unnatural depth of field, focus plane errors, lens simulation issues",
                "obvious liquify tool use, warped features, unrealistic body modification",
                "lighting temperature mismatch, mixed color casts, white balance errors",
                "clipped highlights, blown out areas, lost cloud detail, pure white areas",
                "flash reflection artifacts, catchlights in eyes, direct flash flatness",
                "high pass filter artifacts, overcooked details, texture accentuation",
                "artificial relighting, 3D rendering lighting, fake volumetrics",
                "poor shadow detail, blocked up dark areas, underexposed regions",
                "JPEG compression artifacts, blocky textures, macroblocking, encoding errors",
                "cutout-looking elements, poor masking, hard edges around objects",
                "AI upscaling artifacts, invented details, hallucinated textures",
                "simulated lens dust, artificial flaws, fake imperfections"
            ]
        };

        // Function to generate and update the prompt output
        function updateOutput() {
            const values = {};
            
            // Get values from all input fields
            inputFields.forEach(field => {
                values[field] = document.getElementById(field).value.trim();
            });

            // Add photorealistic base terms if style is empty
            if (!values.style) {
                values.style = "photorealistic, 4k, highly detailed, professional photography";
            } else if (!values.style.toLowerCase().includes("photorealistic")) {
                // Ensure photorealistic is included
                values.style = "photorealistic, " + values.style;
            }
            
            // Build the main prompt with proper formatting
            const mainComponents = [
                values.subject,
                values.environment,
                values.composition,
                values.lighting,
                values.camera,
                values.style
            ];
            
            // Filter out empty components and join with semicolons
            const mainPrompt = mainComponents
                .filter(component => component)
                .join('; ');
            
            // Update the main output field
            outputField.value = mainPrompt;
            
            // Update the negative prompt field with additional anti-CGI terms
            const baseNegativePrompts = "cartoon, anime, illustration, painting, drawing, 3d render, cgi, computer generated, digital art, anime, manga, artificial, unnatural";
            
            let negativePrompt = "";
            if (values.negative) {
                negativePrompt = values.negative + ", " + baseNegativePrompts;
                negativeOutputField.value = negativePrompt;
            } else {
                negativePrompt = baseNegativePrompts;
                negativeOutputField.value = negativePrompt;
            }
            
            // Add to history if there's content and not just a style edit
            if (mainPrompt && values.subject) {
                addToHistory(values, mainPrompt, negativePrompt);
            }
            
            // Auto-copy if enabled and there's content
            if (autoCopyEnabled && mainPrompt) {
                copyToClipboard('main');
            }
        }

        // Function to get a random item from an array
        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        // Randomize all fields button functionality
        randomizeBtn.addEventListener('click', () => {
            // Keep the subject as entered by the user
            const userSubject = document.getElementById('subject').value.trim();
            
            // Randomize all other fields
            Object.keys(variations).forEach(field => {
                document.getElementById(field).value = getRandomItem(variations[field]);
            });
            
            // Update the output
            updateOutput();
        });

        // Clear all fields button functionality
        clearBtn.addEventListener('click', () => {
            inputFields.forEach(field => {
                document.getElementById(field).value = '';
            });
            outputField.value = '';
            negativeOutputField.value = '';
        });

        // Copy functionality with visual feedback
        copyBtn.addEventListener('click', () => copyToClipboard('main'));
        copyNegativeBtn.addEventListener('click', () => copyToClipboard('negative'));
        copyBothBtn.addEventListener('click', () => copyToClipboard('both'));

        function copyToClipboard(type = 'main') {
            let textToCopy = '';
            
            switch(type) {
                case 'main':
                    if (!outputField.value) {
                        alert('Please fill in at least the Subject field to generate a prompt.');
                        return;
                    }
                    textToCopy = outputField.value;
                    break;
                case 'negative':
                    if (!negativeOutputField.value) {
                        alert('No negative prompt to copy.');
                        return;
                    }
                    textToCopy = negativeOutputField.value;
                    break;
                case 'both':
                    if (!outputField.value) {
                        alert('Please fill in at least the Subject field to generate a prompt.');
                        return;
                    }
                    textToCopy = outputField.value;
                    if (negativeOutputField.value) {
                        textToCopy += '\n\nNegative prompt:\n' + negativeOutputField.value;
                    }
                    break;
            }
            
            // Use modern clipboard API if available
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(textToCopy)
                    .then(showCopiedFeedback)
                    .catch(err => {
                        console.error('Failed to copy: ', err);
                        fallbackCopyToClipboard(textToCopy, type);
                    });
            } else {
                fallbackCopyToClipboard(textToCopy, type);
            }
        }

        function fallbackCopyToClipboard(text, type) {
            // Create a temporary textarea for copying
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = text;
            document.body.appendChild(tempTextarea);
            tempTextarea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextarea);
            
            // Show feedback
            showCopiedFeedback();
        }

        function showCopiedFeedback() {
            copyStatus.classList.remove('opacity-0');
            copyStatus.classList.add('opacity-100');
            
            setTimeout(() => {
                copyStatus.classList.remove('opacity-100');
                copyStatus.classList.add('opacity-0');
            }, 2000);
        }

        // Save preset functionality
        savePresetBtn.addEventListener('click', () => {
            // Collect current values
            const preset = {};
            let hasContent = false;
            
            inputFields.forEach(field => {
                const value = document.getElementById(field).value.trim();
                preset[field] = value;
                if (value) hasContent = true;
            });
            
            // Don't save empty presets
            if (!hasContent) {
                alert('Please fill in at least one field to save a preset.');
                return;
            }
            
            // Add timestamp for ID
            preset.id = Date.now();
            preset.name = prompt('Enter a name for this preset:', 'My Preset') || 'Unnamed Preset';
            
            // Save to array and localStorage
            savedPresets.push(preset);
            localStorage.setItem('photoPromptPresets', JSON.stringify(savedPresets));
            
            // Update display
            updatePresetsDisplay();
        });

        // Update presets display
        function updatePresetsDisplay() {
            if (savedPresets.length === 0) {
                savedPresetsContainer.classList.add('hidden');
                return;
            }
            
            // Show container
            savedPresetsContainer.classList.remove('hidden');
            
            // Clear existing presets
            presetList.innerHTML = '';
            
            // Add each preset
            savedPresets.forEach(preset => {
                const presetEl = document.createElement('div');
                presetEl.className = 'p-3 border border-gray-200 dark:border-gray-700 rounded-md hover:border-primary-300 dark:hover:border-primary-500 transition-colors';
                
                presetEl.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-medium text-gray-900 dark:text-white">${preset.name}</h3>
                        <div class="flex gap-1">
                            <button class="apply-preset-btn text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300" data-id="${preset.id}">
                                <i class="fas fa-check-circle"></i>
                            </button>
                            <button class="delete-preset-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${preset.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 truncate">${preset.subject || 'No subject'}</p>
                `;
                
                presetList.appendChild(presetEl);
            });
            
            // Add event listeners to preset buttons
            document.querySelectorAll('.apply-preset-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const presetId = parseInt(e.currentTarget.dataset.id);
                    const preset = savedPresets.find(p => p.id === presetId);
                    
                    if (preset) {
                        // Apply preset values to fields
                        inputFields.forEach(field => {
                            document.getElementById(field).value = preset[field] || '';
                        });
                        
                        // Update output
                        updateOutput();
                    }
                });
            });
            
            document.querySelectorAll('.delete-preset-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const presetId = parseInt(e.currentTarget.dataset.id);
                    
                    // Filter out the preset with matching id
                    const newPresets = savedPresets.filter(p => p.id !== presetId);
                    
                    // Update the array and localStorage
                    savedPresets.length = 0;
                    savedPresets.push(...newPresets);
                    localStorage.setItem('photoPromptPresets', JSON.stringify(savedPresets));
                    
                    // Update display
                    updatePresetsDisplay();
                });
            });
        }

        function toggleHistory() {
            historyCollapsed = !historyCollapsed;
            
            if (historyCollapsed) {
                historyContent.classList.add('hidden');
                historyCollapseIcon.classList.remove('fa-chevron-up');
                historyCollapseIcon.classList.add('fa-chevron-down');
            } else {
                historyContent.classList.remove('hidden');
                historyCollapseIcon.classList.remove('fa-chevron-down');
                historyCollapseIcon.classList.add('fa-chevron-up');
            }
        }
        
        function clearHistory() {
            if (confirm('Are you sure you want to clear your prompt history?')) {
                promptHistory.length = 0;
                localStorage.setItem('photoPromptHistory', JSON.stringify(promptHistory));
                updateHistoryDisplay();
            }
        }
        
        function updateHistoryDisplay() {
            if (promptHistory.length === 0) {
                promptHistoryContainer.classList.add('hidden');
                return;
            }
            
            // Show container
            promptHistoryContainer.classList.remove('hidden');
            
            // Clear existing history items
            historyList.innerHTML = '';
            
            // Add each history item (most recent first)
            [...promptHistory].reverse().forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'p-3 border border-gray-200 dark:border-gray-700 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer';
                
                const timestamp = new Date(item.timestamp).toLocaleString();
                const subjectPreview = item.subject || 'No subject';
                const promptPreview = item.mainPrompt.length > 70 
                    ? item.mainPrompt.substring(0, 70) + '...' 
                    : item.mainPrompt;
                
                historyItem.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <h3 class="font-medium text-gray-900 dark:text-white">${subjectPreview}</h3>
                        <span class="text-xs text-gray-500 dark:text-gray-400">${timestamp}</span>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400">${promptPreview}</p>
                `;
                
                // Add event listener to restore this prompt
                historyItem.addEventListener('click', () => {
                    restoreFromHistory(item);
                });
                
                historyList.appendChild(historyItem);
            });
        }
        
        function restoreFromHistory(historyItem) {
            // Restore all fields from history
            inputFields.forEach(field => {
                document.getElementById(field).value = historyItem[field] || '';
            });
            
            // Update output
            updateOutput();
            
            // Scroll to top of the form
            form.scrollIntoView({ behavior: 'smooth' });
        }
        
        function addToHistory(values, mainPrompt, negativePrompt) {
            // Create history item
            const historyItem = {
                ...values,
                mainPrompt,
                negativePrompt,
                timestamp: Date.now()
            };
            
            // Add to history array (avoid duplicates by checking main prompt)
            const isDuplicate = promptHistory.some(item => 
                item.mainPrompt === mainPrompt && item.negativePrompt === negativePrompt
            );
            
            if (!isDuplicate) {
                promptHistory.unshift(historyItem);
                
                // Limit history size
                if (promptHistory.length > MAX_HISTORY_ITEMS) {
                    promptHistory.pop();
                }
                
                // Save to localStorage
                localStorage.setItem('photoPromptHistory', JSON.stringify(promptHistory));
                
                // Update display
                updateHistoryDisplay();
            }
        }
    </script>
</body>
</html> 